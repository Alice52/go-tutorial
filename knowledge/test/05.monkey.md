## 打桩

1. 概念

   - 屏蔽: 不想在单元测试用引入数据库连接等重资源
   - 补齐: 依赖的上下游函数或方法还未实现

2. monkey 强大的打桩工具

   - 支持为任意函数及**方法(有 receiver)**进行打桩
   - 在运行时通过汇编语言重写可执行文件, 将目标函数或方法的实现跳转到桩实现, 其原理类似于热补丁

   ```go
   go get bou.ke/monkey
   ```

3. monkey 缺点

   - monkey 不支持内联函数: `-gcflags=-l`关闭 Go 语言的内联优化
   - monkey 线程不安全: 不要在并发中使用
